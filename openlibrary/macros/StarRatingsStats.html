$def with(work)

$ rating_stats = work.get_rating_stats() if work else {}
$ stats_by_bookshelf = work.get_num_users_by_bookshelf() if work else {}
$if rating_stats or stats_by_bookshelf:
  $ show_ratings = rating_stats and rating_stats['avg_rating'] > 0 and rating_stats['num_ratings'] > 1

  <ul class="readers-stats" $:cond(show_ratings, 'itemprop="aggregateRating" itemscope itemtype="https://schema.org/AggregateRating"', '')>
      $if show_ratings:
        <li class="avg-ratings">
            $:('<span class="readers-stats__star">â˜…</span>' * int(rating_stats['avg_rating'])) <span itemprop="ratingValue">$(rating_stats['avg_rating'])</span>
        </li>
        <li>
          <span itemprop="reviewCount">$rating_stats['num_ratings']</span> Ratings
        </li>
      $if stats_by_bookshelf.get('want-to-read', 0) > 1:
        <li class="reading-log-stat">$stats_by_bookshelf['want-to-read'] Want to read</li>
      $if stats_by_bookshelf.get('currently-reading', 0) > 1:
        <li class="reading-log-stat">$stats_by_bookshelf['currently-reading'] Currently reading</li>
      $if stats_by_bookshelf.get('already-read', 0) > 1:
        <li class="reading-log-stat">$stats_by_bookshelf['already-read'] Have read</li>
  </ul>

